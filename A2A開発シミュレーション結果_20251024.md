# シミュレーション記録：A2Aアーキテクチャへの第一歩

## シチュエーション設定
- **プロジェクト:** 中小企業向け「経営課題分析・支援策提案AIシステム」
- **目的:** 現在一枚岩（モノリシック）となっているAI思考エンジンを、将来の拡張を見据え、A2A（Agent-to-Agent）アーキテクチャの基本構造へと進化させる。

## シミュレーション前の状態 (As-Is)
- 一つのCloud Runサービス（AI思考エンジン）が、会話ログの受け取り、リスク分析、解決策提案の全ての役割を担っている。
- いわば、「一人の天才が全ての仕事をこなす」状態。

## 実行されたアクション：役割の分離
1.  **専門エージェントの任命:** 既存のCloud Runサービスを、最初の**「リスク分析エージェント（専門家）」**として再定義する。彼の責務は、与えられた会話ログの分析に限定される。
2.  **司令塔エージェントの創設:** 新たにCloud Functionsで**「司令塔エージェント」**を創設する。彼の最初の任務は、ユーザーからのリクエストを受け取り、それを部下である「リスク分析エージェント」のAPIエンドポイントにそのまま委任（HTTP POSTリクエスト）すること。
3.  **インターフェースの確認:** 両エージェント間の会話フォーマットは、既に確立されている `{"conversation_log": "..."}` というJSON形式をそのまま利用する。

## シミュレーション結果 (To-Be)
- **外部的な挙動:** ユーザーから見たシステムの挙動（会話ログを渡すと分析結果が返ってくる）は、以前と全く変わらない。
- **内部的な構造:** システムの内部構造は、**「司令塔が専門家をAPI経由で呼び出す」**という、疎結合なA2Aアーキテクチャへと根本的に進化した。
- **獲得能力:** 今後の開発で、
    - 司令塔をより賢くする（タスク分解能力の追加など）
    - 新しい専門エージェント（財務分析、公募情報検索など）を追加する
    といった拡張を、既存の機能に影響を与えることなく、レゴブロックのように追加していくための**技術的・構造的基盤**が確立された。

---

# 目指すべき目標：災害時初動対応シミュレーション

## シチュエーション設定
- **システム:** 商工会向け「災害時BCP発動・地域対応支援システム」
- **ユーザー:** あなた（商工会の職員、災害対策本部の情報統括担当）
- **トリガー:** 南海トラフ地震が発生（震度6強）。津波警報発令。
- **あなたの指示（プロンプト）:** 「白浜町で地震発生！津波警報が出ている。会員企業の安否と、特にインフラ復旧に必要な建設会社や整備工場の稼働状況を最優先で把握して、動けるリソースをリストアップしてほしい！」
- **司令塔エージェント:** 「災害オペレーション・エージェント」
- **部下エージェントA:** 「被害・安否情報収集エージェント」（自治体情報、SNS、安否確認DBを監視）
- **部下エージェントB:** 「会員リソース管理エージェント」（重機、車両、燃料備蓄DBを管理）

## Situation A: 旧モデル (Gemini 2.5 Pro) の場合
- **司令塔の思考:** 指示を文字通り解釈し、部下Aに「白浜町の全安否情報」、部下Bに「建設・整備業の全リソース」を並行して要求する。
- **最終成果:** 「安否応答20社」「国道通行止め」「A建設：バックホー3台」「D建設（安否未確認）：バックホー2台」といった**生の情報を羅列**して報告する。
- **評価:** 「動けるリソース」になっておらず、あなたが手動で情報を再整理する必要がある。

## Situation B: 新モデル (Gemini 3.0 Pro) の世界観
- **司令塔の思考（進化①）:** あなたの**真の目的は「今すぐ出動可能なチームの特定」**であると理解する。「動ける」を「安否確認済み AND 事業所が津波エリア外 AND リソース保有」と定義し、情報のクロス分析が必要だと判断する。
- **司令塔の行動（進化②）:**
    1.  まず部下Aに「安否確認済みリスト」と「津波浸水域」を要求する。
    2.  次に、部下Aから得た**「安否確認済みリスト」をフィルター条件として**部下Bに渡し、「津波エリア外」の企業に限定してリソースを検索させる。
- **部下エージェントの行動（進化③）:** 高度な絞り込み指示を受け、DBをクロスリファレンスし、条件に合致する企業（B建設、C自動車整備）のみを抽出する。
- **司令塔の最終成果（進化④）:**
    - 「**『今すぐ動けるリソース』**をリストアップしました」と報告。
    - 「B建設（高台）: ブルドーザー2台、連絡先...、推奨アクション: 国道42号線の土砂崩れ対応」
    - 「C自動車整備（内陸）: レッカー車1台、連絡先...、推奨アクション: 緊急車両のトラブル対応待機」
    - 「（※参考: A建設は安否確認済みですが、事業所が浸水想定区域内のため、現時点での稼働は困難と判断しました。）」という**分析的洞察**まで提供する。
- **結論:** v1が「情報の収集」しかできなかったのに対し、v2は**「情報の統合・分析」**を行い、あなたが**次に行うべき行動に直結する「インテリジェンス」**を創出している。